# Saved by TopBraid on Tue Dec 04 08:42:15 CET 2012
# baseURI: http://purl.org/rvl/spin-constraints/
# imports: http://purl.org/rvl/
# imports: http://spinrdf.org/spin
# imports: http://purl.org/viso/facts/

@prefix :        <http://purl.org/rvl/spin-constraints/> .
@prefix facts:   <http://purl.org/viso/facts/> .
@prefix fn:      <http://www.w3.org/2005/xpath-functions#> .
@prefix owl:     <http://www.w3.org/2002/07/owl#> .
@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rvl:     <http://purl.org/rvl/> .
@prefix sp:      <http://spinrdf.org/sp#> .
@prefix spin:    <http://spinrdf.org/spin#> .
@prefix spl:     <http://spinrdf.org/spl#> .
@prefix viso-data:  <http://purl.org/viso/data/> .
@prefix viso-graphic:  <http://purl.org/viso/graphic/> .
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#> .

rvl:PropertyMapping
      rvl:semanticConstraint
              [ rdf:type sp:Construct ;
                rdfs:comment "Test Fixes - Works."^^xsd:string ;
                sp:templates ([ sp:object spin:ConstraintViolation ;
                            sp:predicate rdf:type ;
                            sp:subject _:b1
                          ] [ sp:object spin:_this ;
                            sp:predicate spin:violationRoot ;
                            sp:subject _:b1
                          ] [ sp:object rvl:targetGraphicRelation ;
                            sp:predicate spin:violationPath ;
                            sp:subject _:b1
                          ] [ sp:object "This is a test" ;
                            sp:predicate rdfs:label ;
                            sp:subject _:b1
                          ] [ sp:object _:b2 ;
                            sp:predicate spin:fix ;
                            sp:subject _:b1
                          ] [ sp:object :DeleteTriple ;
                            sp:predicate rdf:type ;
                            sp:subject _:b2
                          ] [ sp:object spin:_this ;
                            sp:predicate rdf:subject ;
                            sp:subject _:b2
                          ] [ sp:object rvl:targetGraphicRelation ;
                            sp:predicate rdf:predicate ;
                            sp:subject _:b2
                          ] [ sp:object _:b3 ;
                            sp:predicate rdf:object ;
                            sp:subject _:b2
                          ]) ;
                sp:where ([ sp:object _:b3 ;
                            sp:predicate rvl:targetGraphicRelation ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:Filter ;
                            sp:expression "false"^^xsd:boolean
                          ])
              ] ;
      rvl:semanticConstraint
              [ rdf:type sp:Ask ;
                rdfs:comment "Expressiveness - The chosen visual means cannot express the given source property (based on it's defined scale of measurement) and according to Mackinlay 1986"^^xsd:string ;
                sp:where ([ sp:object _:b4 ;
                            sp:predicate rvl:sourceProperty ;
                            sp:subject spin:_this
                          ] [ sp:object _:b5 ;
                            sp:predicate rvl:targetGraphicRelation ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:TriplePath ;
                            sp:object _:b6 ;
                            sp:path [ rdf:type sp:SeqPath ;
                                      sp:path1 viso-data:has_scale_of_measurement ;
                                      sp:path2
                                              [ rdf:type sp:ModPath ;
                                                sp:modMax -2 ;
                                                sp:modMin 0 ;
                                                sp:subPath rdfs:subClassOf
                                              ]
                                    ] ;
                            sp:subject _:b4
                          ] [ rdf:type sp:TriplePath ;
                            sp:object viso-data:Scale_of_Measurement ;
                            sp:path [ rdf:type sp:ModPath ;
                                      sp:modMax -2 ;
                                      sp:modMin 1 ;
                                      sp:subPath rdfs:subClassOf
                                    ] ;
                            sp:subject _:b6
                          ] [ sp:object _:b7 ;
                            sp:predicate rdfs:subClassOf ;
                            sp:subject _:b8
                          ] [ sp:object viso-data:has_scale_of_measurement ;
                            sp:predicate owl:onProperty ;
                            sp:subject _:b7
                          ] [ sp:object _:b6 ;
                            sp:predicate owl:allValuesFrom ;
                            sp:subject _:b7
                          ] [ sp:object _:b8 ;
                            sp:predicate facts:not_expresses ;
                            sp:subject _:b5
                          ] [ rdf:type sp:Filter ;
                            sp:expression "false"^^xsd:boolean
                          ])
              ] ;
      rvl:semanticConstraint
              [ rdf:type sp:Construct ;
                rdfs:comment """Effectiveness - Shows a warning when there are more effective visual means and offers to delete the not-best one
TODO: offer better ones!"""^^xsd:string ;
                sp:templates ([ sp:object spin:ConstraintViolation ;
                            sp:predicate rdf:type ;
                            sp:subject _:b9
                          ] [ sp:object spin:_this ;
                            sp:predicate spin:violationRoot ;
                            sp:subject _:b9
                          ] [ sp:object rvl:targetGraphicRelation ;
                            sp:predicate spin:violationPath ;
                            sp:subject _:b9
                          ] [ sp:object _:b10 ;
                            sp:predicate rdfs:label ;
                            sp:subject _:b9
                          ] [ sp:object _:b11 ;
                            sp:predicate spin:fix ;
                            sp:subject _:b9
                          ] [ sp:object :DeleteTriple ;
                            sp:predicate rdf:type ;
                            sp:subject _:b11
                          ] [ sp:object spin:_this ;
                            sp:predicate rdf:subject ;
                            sp:subject _:b11
                          ] [ sp:object rvl:targetGraphicRelation ;
                            sp:predicate rdf:predicate ;
                            sp:subject _:b11
                          ] [ sp:object _:b12 ;
                            sp:predicate rdf:object ;
                            sp:subject _:b11
                          ]) ;
                sp:where ([ sp:object _:b13 ;
                            sp:predicate rvl:sourceProperty ;
                            sp:subject spin:_this
                          ] [ sp:object _:b12 ;
                            sp:predicate rvl:targetGraphicRelation ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:SubQuery ;
                            sp:query
                                    [ rdf:type sp:Select ;
                                      sp:groupBy (_:b13) ;
                                      sp:resultVariables (_:b13 [ sp:expression
                                                          [ rdf:type sp:Count ;
                                                            sp:expression spin:_this
                                                          ] ;
                                                  sp:varName "altCount"^^xsd:string
                                                ]) ;
                                      sp:where ([ sp:object _:b13 ;
                                                  sp:predicate rvl:sourceProperty ;
                                                  sp:subject spin:_this
                                                ] [ sp:object _:b12 ;
                                                  sp:predicate rvl:targetGraphicRelation ;
                                                  sp:subject spin:_this
                                                ] [ rdf:type sp:TriplePath ;
                                                  sp:object _:b14 ;
                                                  sp:path [ rdf:type sp:SeqPath ;
                                                            sp:path1 viso-data:has_scale_of_measurement ;
                                                            sp:path2
                                                                    [ rdf:type sp:ModPath ;
                                                                      sp:modMax -2 ;
                                                                      sp:modMin 0 ;
                                                                      sp:subPath rdfs:subClassOf
                                                                    ]
                                                          ] ;
                                                  sp:subject _:b13
                                                ] [ rdf:type sp:TriplePath ;
                                                  sp:object viso-data:Scale_of_Measurement ;
                                                  sp:path [ rdf:type sp:ModPath ;
                                                            sp:modMax -2 ;
                                                            sp:modMin 1 ;
                                                            sp:subPath rdfs:subClassOf
                                                          ] ;
                                                  sp:subject _:b14
                                                ] [ rdf:type sp:Optional ;
                                                  sp:elements ([ rdf:type sp:Bind ;
                                                              sp:expression viso-data:Nominal_Scale_of_Measurement ;
                                                              sp:variable _:b14
                                                            ] [ sp:object _:b15 ;
                                                              sp:predicate facts:has_effectiveness_ranking_for_nominal_data ;
                                                              sp:subject _:b12
                                                            ] [ sp:object _:b16 ;
                                                              sp:predicate facts:has_effectiveness_ranking_for_nominal_data ;
                                                              sp:subject _:b17
                                                            ])
                                                ] [ rdf:type sp:Optional ;
                                                  sp:elements ([ rdf:type sp:Bind ;
                                                              sp:expression viso-data:Ordinal_Scale_of_Measurement ;
                                                              sp:variable _:b14
                                                            ] [ sp:object _:b15 ;
                                                              sp:predicate facts:has_effectiveness_ranking_for_ordinal_data ;
                                                              sp:subject _:b12
                                                            ] [ sp:object _:b16 ;
                                                              sp:predicate facts:has_effectiveness_ranking_for_ordinal_data ;
                                                              sp:subject _:b17
                                                            ])
                                                ] [ rdf:type sp:Optional ;
                                                  sp:elements ([ rdf:type sp:Bind ;
                                                              sp:expression viso-data:Quantitative_Scale_of_Measurement ;
                                                              sp:variable _:b14
                                                            ] [ sp:object _:b15 ;
                                                              sp:predicate facts:has_effectiveness_ranking_for_quantitative_data ;
                                                              sp:subject _:b12
                                                            ] [ sp:object _:b16 ;
                                                              sp:predicate facts:has_effectiveness_ranking_for_quantitative_data ;
                                                              sp:subject _:b17
                                                            ])
                                                ] [ rdf:type sp:Filter ;
                                                  sp:expression
                                                          [ rdf:type sp:and ;
                                                            sp:arg1 [ rdf:type sp:bound ;
                                                                      sp:arg1 _:b15
                                                                    ] ;
                                                            sp:arg2 [ rdf:type sp:bound ;
                                                                      sp:arg1 _:b16
                                                                    ]
                                                          ]
                                                ] [ rdf:type sp:Filter ;
                                                  sp:expression
                                                          [ rdf:type sp:ne ;
                                                            sp:arg1 _:b12 ;
                                                            sp:arg2 _:b17
                                                          ]
                                                ] [ rdf:type sp:Filter ;
                                                  sp:expression
                                                          [ rdf:type sp:gt ;
                                                            sp:arg1 _:b16 ;
                                                            sp:arg2 _:b15
                                                          ]
                                                ])
                                    ]
                          ] [ rdf:type sp:Bind ;
                            sp:expression
                                    [ rdf:type fn:concat ;
                                      sp:arg1 "There are " ;
                                      sp:arg2 _:b18 ;
                                      sp:arg3 " more effective visual means for visualizing the selected source property"
                                    ] ;
                            sp:variable _:b10
                          ] [ rdf:type sp:Filter ;
                            sp:expression
                                    [ rdf:type sp:gt ;
                                      sp:arg1 _:b18 ;
                                      sp:arg2 0
                                    ]
                          ])
              ] ;
      rvl:semanticConstraint
              [ rdf:type sp:Construct ;
                rdfs:comment "Test CONSTRUCT-CONSTRAINT with Subquery WORKS!! \"this\" is bound and 4 triples created"^^xsd:string ;
                sp:templates ([ sp:object spin:ConstraintViolation ;
                            sp:predicate rdf:type ;
                            sp:subject _:b19
                          ] [ sp:object spin:_this ;
                            sp:predicate spin:violationRoot ;
                            sp:subject _:b19
                          ] [ sp:object rvl:targetGraphicRelation ;
                            sp:predicate spin:violationPath ;
                            sp:subject _:b19
                          ] [ sp:object "This is a test" ;
                            sp:predicate rdfs:label ;
                            sp:subject _:b19
                          ]) ;
                sp:where ([ rdf:type sp:SubQuery ;
                            sp:query
                                    [ rdf:type sp:Select ;
                                      sp:where ([ rdf:type sp:Bind ;
                                                  sp:expression "test" ;
                                                  sp:variable
                                                          [ sp:varName "test"^^xsd:string
                                                          ]
                                                ])
                                    ]
                          ] [ rdf:type sp:Filter ;
                            sp:expression "false"^^xsd:boolean
                          ])
              ] ;
      rvl:semanticConstraint
              [ rdf:type sp:Ask ;
                rdfs:comment "Appropriateness - The chosen visual means is not appropriate to visualize the given source property (based on it's defined scale of measurement)"^^xsd:string ;
                sp:where ([ sp:object _:b20 ;
                            sp:predicate rvl:sourceProperty ;
                            sp:subject spin:_this
                          ] [ sp:object _:b21 ;
                            sp:predicate rvl:targetGraphicRelation ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:TriplePath ;
                            sp:object _:b22 ;
                            sp:path [ rdf:type sp:SeqPath ;
                                      sp:path1 viso-data:has_scale_of_measurement ;
                                      sp:path2
                                              [ rdf:type sp:ModPath ;
                                                sp:modMax -2 ;
                                                sp:modMin 0 ;
                                                sp:subPath rdfs:subClassOf
                                              ]
                                    ] ;
                            sp:subject _:b20
                          ] [ rdf:type sp:TriplePath ;
                            sp:object viso-data:Scale_of_Measurement ;
                            sp:path [ rdf:type sp:ModPath ;
                                      sp:modMax -2 ;
                                      sp:modMin 1 ;
                                      sp:subPath rdfs:subClassOf
                                    ] ;
                            sp:subject _:b22
                          ] [ sp:object _:b23 ;
                            sp:predicate rdfs:subClassOf ;
                            sp:subject _:b24
                          ] [ sp:object viso-data:has_scale_of_measurement ;
                            sp:predicate owl:onProperty ;
                            sp:subject _:b23
                          ] [ sp:object _:b22 ;
                            sp:predicate owl:allValuesFrom ;
                            sp:subject _:b23
                          ] [ sp:object _:b24 ;
                            sp:predicate facts:not_appropriate_to_visualize ;
                            sp:subject _:b21
                          ] [ sp:object _:b24 ;
                            sp:predicate facts:expresses ;
                            sp:subject _:b21
                          ] [ rdf:type sp:Filter ;
                            sp:expression "false"^^xsd:boolean
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "Upper bound may not be less than lower bound (of target values)."^^xsd:string ;
                sp:where ([ sp:object _:b25 ;
                            sp:predicate rvl:targetValueLowerBoundIncl ;
                            sp:subject spin:_this
                          ] [ sp:object _:b26 ;
                            sp:predicate rvl:targetValueUpperBoundIncl ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:Filter ;
                            sp:expression
                                    [ rdf:type sp:lt ;
                                      sp:arg1 _:b26 ;
                                      sp:arg2 _:b25
                                    ]
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "The target values are ordered. Shouldn't be the source side also be ordered? You may ignore this."^^xsd:string ;
                sp:where ([ sp:object "true"^^xsd:boolean ;
                            sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_targets_ordered> ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object "true"^^xsd:boolean ;
                                        sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_sources_ordered> ;
                                        sp:subject spin:_this
                                      ])
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "SourceValueOutOfBounds may only be defined, when some bound is defined."^^xsd:string ;
                sp:where ([ sp:object
                                    [ sp:varName "oob"^^xsd:string
                                    ] ;
                            sp:predicate rvl:sourceValuesOutOfBounds ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object
                                                [ sp:varName "up"^^xsd:string
                                                ] ;
                                        sp:predicate rvl:sourceValueUpperBoundIncl ;
                                        sp:subject spin:_this
                                      ])
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object
                                                [ sp:varName "lb"^^xsd:string
                                                ] ;
                                        sp:predicate rvl:sourceValueLowerBoundIncl ;
                                        sp:subject spin:_this
                                      ])
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object
                                                [ sp:varName "dtpup"^^xsd:string
                                                ] ;
                                        sp:predicate rvl:sourceValueUpperBoundDTP ;
                                        sp:subject spin:_this
                                      ])
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object
                                                [ sp:varName "dtplb"^^xsd:string
                                                ] ;
                                        sp:predicate rvl:sourceValueLowerBoundDTP ;
                                        sp:subject spin:_this
                                      ])
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "You can either define a list of source values or give bounds"^^xsd:string ;
                sp:where ([ sp:object
                                    [ sp:varName "sv"^^xsd:string
                                    ] ;
                            sp:predicate rvl:sourceValueSet ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:Union ;
                            sp:elements (([ sp:object _:b27 ;
                                          sp:predicate rvl:sourceValueUpperBoundIncl ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b28 ;
                                          sp:predicate rvl:sourceValueLowerBoundIncl ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b27 ;
                                          sp:predicate rvl:sourceValueUpperBoundDTP ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b28 ;
                                          sp:predicate rvl:sourceValueLowerBoundDTP ;
                                          sp:subject spin:_this
                                        ]))
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "target value bounds (min/max) may only be set when values are ordered (any bounds - OP and DTP bounds)"^^xsd:string ;
                sp:where ([ rdf:type sp:Union ;
                            sp:elements (([ sp:object _:b29 ;
                                          sp:predicate rvl:targetValueUpperBoundIncl ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b29 ;
                                          sp:predicate rvl:targetValueLowerBoundIncl ;
                                          sp:subject spin:_this
                                        ]))
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object "true"^^xsd:boolean ;
                                        sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_targets_ordered> ;
                                        sp:subject spin:_this
                                      ])
                          ])
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "A continous value for the upper bound of source values"^^xsd:string ;
                spl:maxCount 1 ;
                spl:predicate rvl:sourceValueUpperBoundDTP ;
                spl:valueType xsd:float
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "The source values are ordered. Shouldn't be the target side also be ordered? You may ignore the information on order."^^xsd:string ;
                sp:where ([ sp:object "true"^^xsd:boolean ;
                            sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_sources_ordered> ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object "true"^^xsd:boolean ;
                                        sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_targets_ordered> ;
                                        sp:subject spin:_this
                                      ])
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "Value mappings may only be defined for property mapping that do NOT map to continuous attributes"^^xsd:string ;
                sp:where ([ sp:object
                                    [ sp:varName "vm"^^xsd:string
                                    ] ;
                            sp:predicate rvl:valueMapping ;
                            sp:subject spin:_this
                          ] [ sp:object _:b30 ;
                            sp:predicate rvl:targetGraphicRelation ;
                            sp:subject spin:_this
                          ] [ sp:object viso-graphic:GraphicAttributeContinuous ;
                            sp:predicate rdf:type ;
                            sp:subject _:b30
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "Upper bound may not be less than lower bound (of source values)."^^xsd:string ;
                sp:where ([ sp:object _:b31 ;
                            sp:predicate rvl:sourceValueLowerBoundDTP ;
                            sp:subject spin:_this
                          ] [ sp:object _:b32 ;
                            sp:predicate rvl:sourceValueUpperBoundDTP ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:Filter ;
                            sp:expression
                                    [ rdf:type sp:lt ;
                                      sp:arg1 _:b32 ;
                                      sp:arg2 _:b31
                                    ]
                          ])
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "The target visual means may only be a single visual means as defined in the VISO."^^xsd:string ;
                spl:maxCount 1 ;
                spl:minCount 1 ;
                spl:predicate rvl:targetGraphicRelation ;
                spl:valueType viso-graphic:GraphicRelation
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "Only one value list may be given"^^xsd:string ;
                spl:maxCount 1 ;
                spl:minCount 0 ;
                spl:predicate rvl:targetValueList ;
                spl:valueType viso-graphic:Visual_Value_List
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "DTP bounds may not be set when we are mapping a discrete (ObjectProperty) source property"^^xsd:string ;
                sp:where ([ sp:object _:b33 ;
                            sp:predicate rvl:sourceProperty ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:Union ;
                            sp:elements (([ sp:object
                                                  [ sp:varName "ub"^^xsd:string
                                                  ] ;
                                          sp:predicate rvl:sourceValueUpperBoundDTP ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object
                                                  [ sp:varName "lb"^^xsd:string
                                                  ] ;
                                          sp:predicate rvl:sourceValueLowerBoundDTP ;
                                          sp:subject spin:_this
                                        ]))
                          ] [ sp:object owl:ObjectProperty ;
                            sp:predicate rdf:type ;
                            sp:subject _:b33
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "OP bounds may not be set when we are mapping a continuous (DT) source property"^^xsd:string ;
                sp:where ([ sp:object _:b34 ;
                            sp:predicate rvl:sourceProperty ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:Union ;
                            sp:elements (([ sp:object
                                                  [ sp:varName "ub"^^xsd:string
                                                  ] ;
                                          sp:predicate rvl:sourceValueUpperBoundIncl ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object
                                                  [ sp:varName "lb"^^xsd:string
                                                  ] ;
                                          sp:predicate rvl:sourceValueLowerBoundIncl ;
                                          sp:subject spin:_this
                                        ]))
                          ] [ sp:object owl:DatatypeProperty ;
                            sp:predicate rdf:type ;
                            sp:subject _:b34
                          ])
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "Lower bound for a continuous source value"^^xsd:string ;
                spl:maxCount 1 ;
                spl:predicate rvl:sourceValueLowerBoundDTP ;
                spl:valueType xsd:float
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "The default is to set values out of bounds to the bounds (clamp)."^^xsd:string ;
                spl:defaultValue rvl:Clamp ;
                spl:predicate rvl:sourceValuesOutOfBounds ;
                spl:valueType rvl:OutOfBoundHandlingType
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "source value bounds may only be set when values are ordered"^^xsd:string ;
                sp:where ([ rdf:type sp:Union ;
                            sp:elements (([ sp:object _:b35 ;
                                          sp:predicate rvl:sourceValueUpperBoundDTP ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b35 ;
                                          sp:predicate rvl:sourceValueLowerBoundDTP ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b35 ;
                                          sp:predicate rvl:sourceValueUpperBoundIncl ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b35 ;
                                          sp:predicate rvl:sourceValueLowerBoundIncl ;
                                          sp:subject spin:_this
                                        ]))
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object "true"^^xsd:boolean ;
                                        sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_sources_ordered> ;
                                        sp:subject spin:_this
                                      ])
                          ])
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "Linear is the default interpolation type"^^xsd:string ;
                spl:defaultValue rvl:Linear ;
                spl:predicate rvl:scaleTransformation ;
                spl:valueType rvl:ScaleTransformationType
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "The source property may only be a single rdf:Property."^^xsd:string ;
                spl:maxCount 1 ;
                spl:minCount 1 ;
                spl:predicate rvl:sourceProperty ;
                spl:valueType rdf:Property
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "value mappings may not be defined, when mapping to a visual relation (VSS)"^^xsd:string ;
                sp:where ([ sp:object _:b36 ;
                            sp:predicate rvl:targetGraphicRelation ;
                            sp:subject spin:_this
                          ] [ sp:object viso-graphic:GraphicObjectToObjectRelation ;
                            sp:predicate rdf:type ;
                            sp:subject _:b36
                          ] [ sp:object
                                    [ sp:varName "vm"^^xsd:string
                                    ] ;
                            sp:predicate rvl:valueMapping ;
                            sp:subject spin:_this
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "Value lists may only be used as cyclic lists, when there are more source than target values defined. !!! MAKES NO SENSE AT THE MOMENT, SINCE IT ONLY WORKS ON VALUELISTS, but checks if single values are given! DIFFICULT to count LIST members?!"^^xsd:string ;
                sp:where ([ sp:object
                                    [ sp:varName "useValueListAsCycle"^^xsd:string
                                    ] ;
                            sp:predicate rvl:targetValueCycle ;
                            sp:subject spin:_this
                          ] [ sp:object
                                    [ sp:varName "sv"^^xsd:string
                                    ] ;
                            sp:predicate rvl:sourceValue ;
                            sp:subject spin:_this
                          ] [ sp:object
                                    [ sp:varName "tv"^^xsd:string
                                    ] ;
                            sp:predicate rvl:targetValue ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:Filter ;
                            sp:expression
                                    [ rdf:type sp:le ;
                                      sp:arg1 [ rdf:type spl:objectCount ;
                                                sp:arg1 spin:_this ;
                                                sp:arg2 rvl:sourceValue
                                              ] ;
                                      sp:arg2 [ rdf:type spl:objectCount ;
                                                sp:arg1 spin:_this ;
                                                sp:arg2 rvl:targetValue
                                              ]
                                    ]
                          ])
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "Property must be at least transitive to be usable as order relation property"^^xsd:string ;
                sp:where ([ sp:object _:b37 ;
                            sp:predicate rvl:orderSourceValuesBy ;
                            sp:subject spin:_this
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object owl:TransitiveProperty ;
                                        sp:predicate rdf:type ;
                                        sp:subject _:b37
                                      ])
                          ])
              ] ;
      spin:rule
              [ rdf:type sp:Construct ;
                rdfs:comment "targets are ordered when a value LIST is given, or when a continuous attribute is chosen"^^xsd:string ;
                sp:templates ([ sp:object "true"^^xsd:boolean ;
                            sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_targets_ordered> ;
                            sp:subject spin:_this
                          ]) ;
                sp:where ([ rdf:type sp:Union ;
                            sp:elements (([ sp:object
                                                  [ sp:varName "tvallist"^^xsd:string
                                                  ] ;
                                          sp:predicate rvl:targetValueList ;
                                          sp:subject spin:_this
                                        ]) ([ sp:object _:b38 ;
                                          sp:predicate rvl:targetGraphicRelation ;
                                          sp:subject spin:_this
                                        ] [ sp:object viso-graphic:GraphicAttributeContinuous ;
                                          sp:predicate rdf:type ;
                                          sp:subject _:b38
                                        ]))
                          ])
              ] ;
      spin:rule
              [ rdf:type sp:Construct ;
                rdfs:comment "sources are NOT ordered for string and boolean DTP properties"^^xsd:string ;
                sp:templates ([ sp:object "false"^^xsd:boolean ;
                            sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_sources_ordered> ;
                            sp:subject spin:_this
                          ]) ;
                sp:where ([ sp:object _:b39 ;
                            sp:predicate rvl:sourceProperty ;
                            sp:subject spin:_this
                          ] [ sp:object owl:DatatypeProperty ;
                            sp:predicate rdf:type ;
                            sp:subject _:b39
                          ] [ rdf:type sp:Union ;
                            sp:elements (([ sp:object xsd:boolean ;
                                          sp:predicate rdfs:range ;
                                          sp:subject _:b39
                                        ]) ([ sp:object xsd:string ;
                                          sp:predicate rdfs:range ;
                                          sp:subject _:b39
                                        ]))
                          ])
              ] ;
      spin:rule
              [ rdf:type sp:Construct ;
                rdfs:comment """targets are ordered when all values have an ordinal value attached to them
HERE also spin-owl could be used in combination with an all-quantification restriction on the class"""^^xsd:string ;
                sp:templates ([ sp:object "true"^^xsd:boolean ;
                            sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_targets_ordered> ;
                            sp:subject spin:_this
                          ]) ;
                sp:where ([ sp:object _:b40 ;
                            sp:predicate rvl:targetValue ;
                            sp:subject spin:_this
                          ] [ sp:object
                                    [ sp:varName "ov1"^^xsd:string
                                    ] ;
                            sp:predicate viso-data:has_ordinal_value ;
                            sp:subject _:b40
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object _:b41 ;
                                        sp:predicate rvl:targetValue ;
                                        sp:subject spin:_this
                                      ] [ rdf:type sp:NotExists ;
                                        sp:elements ([ sp:object
                                                            [ sp:varName "ov"^^xsd:string
                                                            ] ;
                                                    sp:predicate viso-data:has_ordinal_value ;
                                                    sp:subject _:b41
                                                  ])
                                      ])
                          ])
              ] ;
      spin:rule
              [ rdf:type sp:Construct ;
                rdfs:comment "sources are ordered when a list or order relation is given for OP, or for numeral DTP properties"^^xsd:string ;
                sp:templates ([ sp:object "true"^^xsd:boolean ;
                            sp:predicate <http://purl.org/rvl/rvl2avm/spin/helper_sources_ordered> ;
                            sp:subject spin:_this
                          ]) ;
                sp:where ([ sp:object _:b42 ;
                            sp:predicate rvl:sourceProperty ;
                            sp:subject spin:_this
                          ] [ sp:object rdf:Property ;
                            sp:predicate rdf:type ;
                            sp:subject _:b42
                          ] ([ rdf:type sp:Union ;
                              sp:elements (([ sp:object _:b43 ;
                                            sp:predicate rvl:orderSourceValuesBy ;
                                            sp:subject spin:_this
                                          ] [ sp:object owl:TransitiveProperty ;
                                            sp:predicate rdf:type ;
                                            sp:subject _:b43
                                          ]) ([ sp:object _:b44 ;
                                            sp:predicate rvl:sourceValueSet ;
                                            sp:subject spin:_this
                                          ] [ sp:object rdf:List ;
                                            sp:predicate rdf:type ;
                                            sp:subject _:b44
                                          ]) ([ sp:object _:b42 ;
                                            sp:predicate rvl:sourceProperty ;
                                            sp:subject spin:_this
                                          ] [ sp:object owl:DatatypeProperty ;
                                            sp:predicate rdf:type ;
                                            sp:subject _:b42
                                          ] ([ rdf:type sp:Union ;
                                              sp:elements (([ sp:object xsd:float ;
                                                            sp:predicate rdfs:range ;
                                                            sp:subject _:b42
                                                          ]) ([ sp:object xsd:int ;
                                                            sp:predicate rdfs:range ;
                                                            sp:subject _:b42
                                                          ]))
                                            ])))
                            ]))
              ] .

rvl:ValueMapping
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "A value mapping must have exactly one target visual value."^^xsd:string ;
                spl:maxCount 1 ;
                spl:minCount 1 ;
                spl:predicate rvl:targetValue ;
                spl:valueType viso-graphic:Visual_Attribute
              ] ;
      spin:constraint
              [ rdf:type spl:Attribute ;
                rdfs:comment "A value mapping must have exactly one source value."^^xsd:string ;
                spl:maxCount 1 ;
                spl:minCount 1 ;
                spl:predicate rvl:sourceValue ;
                spl:valueType rdfs:Resource
              ] ;
      spin:constraint
              [ rdf:type sp:Ask ;
                rdfs:comment "targetValue may only take values of the range of targetVisualMeans of the property mapping it belongs to"^^xsd:string ;
                sp:where ([ sp:object spin:_this ;
                            sp:predicate rvl:valueMapping ;
                            sp:subject _:b45
                          ] [ sp:object _:b46 ;
                            sp:predicate rvl:targetValue ;
                            sp:subject spin:_this
                          ] [ sp:object _:b47 ;
                            sp:predicate rvl:targetGraphicRelation ;
                            sp:subject _:b45
                          ] [ sp:object _:b48 ;
                            sp:predicate rdfs:range ;
                            sp:subject _:b47
                          ] [ rdf:type sp:NotExists ;
                            sp:elements ([ sp:object _:b48 ;
                                        sp:predicate rdf:type ;
                                        sp:subject _:b46
                                      ])
                          ])
              ] .

rvl:semanticConstraint
      rdf:type rdf:Property ;
      rdfs:subPropertyOf spin:constraint .

rvl:sourceValueLowerBoundDTP
      rdf:type owl:DatatypeProperty .

rvl:sourceValueUpperBoundDTP
      rdf:type owl:DatatypeProperty .

:     rdf:type owl:Ontology ;
      owl:imports <http://spinrdf.org/spin> , facts: , rvl: ;
      owl:versionInfo "Created with TopBraid Composer"^^xsd:string .

:DeleteTriple
      rdf:type spin:UpdateTemplate ;
      rdfs:subClassOf spin:UpdateTemplates ;
      spin:body
              [ rdf:type sp:Modify ;
                sp:deletePattern ([ sp:object _:b49 ;
                            sp:predicate _:b50 ;
                            sp:subject _:b51
                          ]) ;
                sp:where ([ sp:object _:b49 ;
                            sp:predicate _:b50 ;
                            sp:subject _:b51
                          ])
              ] ;
      spin:constraint
              [ rdf:type spl:Argument ;
                rdfs:comment "The predicate of the triple to delete."^^xsd:string ;
                spl:optional "false"^^xsd:boolean ;
                spl:predicate rdf:predicate ;
                spl:valueType rdf:Property
              ] ;
      spin:constraint
              [ rdf:type spl:Argument ;
                rdfs:comment "The object of the triple to delete."^^xsd:string ;
                spl:optional "false"^^xsd:boolean ;
                spl:predicate rdf:object ;
                spl:valueType rdfs:Resource
              ] ;
      spin:constraint
              [ rdf:type spl:Argument ;
                rdfs:comment "The subject of the triple to delete."^^xsd:string ;
                spl:optional "false"^^xsd:boolean ;
                spl:predicate rdf:subject ;
                spl:valueType rdfs:Resource
              ] ;
      spin:labelTemplate "Delete triple {?subject} {?predicate} {?object}"^^xsd:string .

:InvalidPM
      rdfs:label "Invalid PM"^^xsd:string ;
      rvl:includeInLegend "true"^^xsd:boolean ;
      rvl:sourceValueLowerBoundDTP
              "50"^^xsd:float ;
      rvl:sourceValueUpperBoundDTP
              "40"^^xsd:float .

:InvalidSortedMapping
      rdf:type rvl:PropertyMapping ;
      <http://purl.org/rvl/rvl2avm/spin/helper_sources_ordered>
              "true"^^xsd:boolean ;
      <http://purl.org/rvl/rvl2avm/spin/helper_targets_ordered>
              "true"^^xsd:boolean ;
      rvl:sourceProperty viso-graphic:greater_than ;
      rvl:targetGraphicRelation
              viso-graphic:position ;
      rvl:targetValue viso-graphic:SmallSize , viso-graphic:BigSize , viso-graphic:MediumSize ;
      rvl:targetValueLowerBoundIncl
              viso-graphic:MediumSize ;
      rvl:targetValueUpperBoundIncl
              viso-graphic:SmallSize .

:List_1
      rdf:type rdf:List .

:List_2
      rdf:type rdf:List .

:MappingWithANotBestRankedVisualMeans
      rdf:type rvl:PropertyMapping ;
      rvl:sourceProperty rdfs:label ;
      rvl:targetGraphicRelation
              viso-graphic:color_hsl_saturation .

:MappingWithBrokenSemanticConstraints
      rdf:type rvl:PropertyMapping ;
      rvl:sourceProperty <http://www.w3.org/2003/01/geo/wgs84_pos#lat> ;
      rvl:targetGraphicRelation
              viso-graphic:color_hsl_hue .

:SizeWithoutOrdinalInformation
      rdf:type viso-graphic:Size .

:ValueMapping_1
      rdf:type rvl:ValueMapping ;
      rvl:includeInLegend "true"^^xsd:boolean ;
      rvl:sourceValue viso-graphic:Visualisation ;
      rvl:targetValue viso-graphic:Red .

_:b51
      sp:varName "subject"^^xsd:string .

_:b50
      sp:varName "predicate"^^xsd:string .

_:b49
      sp:varName "object"^^xsd:string .

_:b48
      sp:varName "range"^^xsd:string .

_:b47
      sp:varName "tvm"^^xsd:string .

_:b46
      sp:varName "tv"^^xsd:string .

_:b45
      sp:varName "pm"^^xsd:string .

_:b38
      sp:varName "tvm"^^xsd:string .

_:b39
      sp:varName "sp"^^xsd:string .

_:b44
      sp:varName "sval"^^xsd:string .

_:b43
      sp:varName "orel"^^xsd:string .

_:b42
      sp:varName "sp"^^xsd:string .

_:b41
      sp:varName "tv"^^xsd:string .

_:b40
      sp:varName "tv1"^^xsd:string .

_:b36
      sp:varName "tvm"^^xsd:string .

_:b34
      sp:varName "sp"^^xsd:string .

_:b29
      sp:varName "b"^^xsd:string .

_:b26
      sp:varName "ub"^^xsd:string .

_:b25
      sp:varName "lb"^^xsd:string .

_:b37
      sp:varName "orp"^^xsd:string .

_:b35
      sp:varName "b"^^xsd:string .

_:b28
      sp:varName "lb"^^xsd:string .

_:b27
      sp:varName "ub"^^xsd:string .

_:b30
      sp:varName "tvm"^^xsd:string .

_:b33
      sp:varName "sp"^^xsd:string .

_:b32
      sp:varName "ub"^^xsd:string .

_:b31
      sp:varName "lb"^^xsd:string .

_:b8  sp:varName "data_kind"^^xsd:string .

_:b7  sp:varName "restriction"^^xsd:string .

_:b6  sp:varName "spSoM"^^xsd:string .

_:b5  sp:varName "tvm"^^xsd:string .

_:b4  sp:varName "sp"^^xsd:string .

_:b24
      sp:varName "data_kind"^^xsd:string .

_:b23
      sp:varName "restriction"^^xsd:string .

_:b22
      sp:varName "spSoM"^^xsd:string .

_:b21
      sp:varName "tvm"^^xsd:string .

_:b20
      sp:varName "sp"^^xsd:string .

_:b3  sp:varName "tvm"^^xsd:string .

_:b18
      sp:varName "altCount"^^xsd:string .

_:b17
      sp:varName "anyOtherVm"^^xsd:string .

_:b16
      sp:varName "otherRankValue"^^xsd:string .

_:b15
      sp:varName "rankValue"^^xsd:string .

_:b14
      sp:varName "spSoM"^^xsd:string .

_:b13
      sp:varName "sp"^^xsd:string .

_:b12
      sp:varName "tvm"^^xsd:string .

_:b10
      sp:varName "cvLabel"^^xsd:string .
