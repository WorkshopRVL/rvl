<!DOCTYPE html>
<meta charset="utf-8">
<style>

	.link line {
	    stroke: gray;
	}
	.link line.separator {
	    stroke: white;
	}
	.node circle {
	    stroke: gray;
	    stroke-width: 10;
	}
	.node text {
	    font: 12px sans-serif;
	    pointer-events: none;
	}
	

</style>
<body></body>
<script src="d3.min.js"></script>
<script>var graph = {"nodes": [
    {"name": "Test",  "size": 12, "company": "X", "location": "ChicagoIL"},
    {"name": "Frank",  "size": 12, "company": "Y", "location": "NewYorkNY"},
    {"name": "Jim",    "size": 12, "company": "Y", "location": "LosAngelesCA"},
    {"name": "Sally",  "size": 12, "company": "Z", "location": "TorontoON"},
    {"name": "Tom",    "size": 12, "company": "X", "location": "ChicagoIL"},
    {"name": "GroupA", "size": 18, "company": "T", "location": "x"},
    {"name": "GroupB", "size": 18, "company": "T", "location": "x"}],
  "links": [
    {"source": 2, "target": 5,  "bond": 3},
    {"source": 3, "target": 5,  "bond": 2},
    {"source": 4, "target": 5,  "bond": 1},
    {"source": 0, "target": 6,  "bond": 1},
    {"source": 1, "target": 6,  "bond": 2},
    {"source": 4, "target": 6,  "bond": 1}]
    };

	var width = 800;
	var height = 800;
	var padding = 20;

	var color = d3.scale.category20();

	var radius = d3.scale.sqrt()
		.range([0, 7]);

	var scale = d3.scale.linear();

	var svg = d3.select("body").append("svg")
		.attr("width", width)
		.attr("height", height);


	var force = d3.layout.force()
		.size([width, height])
		.charge(-400)
		.linkStrength(3)
		.linkDistance(90);

		// network diagram stuff

		force
			.nodes(graph.nodes)
			.links(graph.links)
			.on("tick", tick)
			.start();

		var link = svg.selectAll(".link")
			.data(graph.links)
			.enter().append("g")
			.attr("class", "link");

		link.append("line")
			.style("stroke-width", function(d) { return (d.bond * 2 - 1) * 3 + "px"; });

		link.filter(function(d) { return d.bond == 3; }).append("line")
			.attr("class", "separator");

		var node = svg.selectAll(".node")
			.data(graph.nodes)
			.enter().append("g")
			.attr("class", function(d) { return "node " + d.name + " " + d.location; })
			.call(force.drag)
			.on("mouseover", function(d) { 

					d3.select(this).select("circle").style("stroke-width", 6); 
                
                    // Figure out the neighboring node id's with brute strength because the graph is small
                    var nodeNeighbors = graph.links.filter(function(link) {
                        // Filter the list of links to only those links that have our target 
                        // node as a source or target
                        return link.source.index === d.index || link.target.index === d.index;})
                    .map(function(link) {
                        // Map the list of links to a simple array of the neighboring indices - this is
                        // technically not required but makes the code below simpler because we can use         
                        // indexOf instead of iterating and searching ourselves.
                        return link.source.index === d.index ? link.target.index : link.source.index; });
                    
                    // now we select the neighboring circles and apply whatever style we want. 
                    // Note that we could also filter a selection of links in this way if we want to 
                    // Highlight those as well
                    svg.selectAll('circle').filter(function(node) {
                        // I filter the selection of all circles to only those that hold a node with an
                        // index in my listg of neighbors
                        return nodeNeighbors.indexOf(node.index) > -1;
                    })
                    .style('stroke', 'yellow');
               
					d3.select(this).select("circle").style("stroke", "yellow"); 
					d3.select(this).select("text").style("font", "20px sans-serif");
	
					//}
				})
			.on("mouseout",  function(d) { 

                    svg.selectAll('circle').style('stroke', 'gray');
					d3.select(this).select("circle").style("stroke-width", 1.5); 
					//d3.select(this).select("circle").style("stroke", "gray"); 
					d3.select(this).select("text").style("font", "12px sans-serif");

				});

		node.append("circle")
			.attr("r", function(d) { return radius(d.size); })
			.style("fill", function(d) { return color(d.name); });

		node.append("text")
			.attr("dy", ".35em")
			.attr("text-anchor", "middle")
			.text(function(d) { return d.name; });

		var linkedByIndex = {};
			graph.links.forEach(function(d) {
				linkedByIndex[d.source.index + "," + d.target.index] = 1;
				});

		function isConnected(a, b) {
			return linkedByIndex[a.index + "," + b.index] || linkedByIndex[b.index + "," + a.index] || a.index == b.index;
			}

		function tick() {
			link.selectAll("line")
				.attr("x1", function(d) { return d.source.x; })
				.attr("y1", function(d) { return d.source.y; })
				.attr("x2", function(d) { return d.target.x; })
				.attr("y2", function(d) { return d.target.y; });
			node.attr("transform", function(d) { 
				return "translate(" + d.x + "," + d.y + ")"; });
			}

	



</script>